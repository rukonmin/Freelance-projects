# Сопоставление товаров компании А и Б

## Задача:

Даны нормализованные данные о товаров компании А. Каждый товар содержит 72 признака. В ручную сопоставлены товары компании А и Б. Необходимо построить модель, которая поможет автоматически сопоставлять товары компании Б товарам компании А.

В качестве метрики качества используется:

$accuracy@5 = 100\times \frac{\text{количество верно определенных положений объектов из 5 возможных}}{5}$

Примечание: рекомендуется достигнуть значения не ниже `0.7`.


## Заключение

В данной работе осуществлено решение задачи по сопоставлению объектов A и B при наличии частично обученных данных.

Для решения задачи использовался полный набор данных (`~2 млн. записей`) и уменьшенных набора данных (`~300 тыс. записей`).

При работе с полным набором данных возникли проблемы с ограниченностью ресурсов 12Гб ОЗУ. в следствии расчёты не удавалось сделать в полном объеме, плюс значительно увеличивалось время расчетов данных.

В связи с этим для решения задачи принято решение использовать сокращенные данные.

В ходе анализа данных было выявлено, что параметры с номерами `33` и `59` имеют большой разброс ошибок. Поэтому были исключены из расчётов модели.

Была изучена метрика `L2` и `L1` с различными видами нормализации данных, а также попытка найти оптимальные значения параметров для соответствующих метрик.

Была построена визуализация данных после применения методов `PCA` и `PCA + T-SNE`.

Изучено влияние количества кластеров модели KMean на метрики характеризующие кластеризацию:
- метод локтя;
- метод силуэта;
- метод `Davies-Bouldin`.

По результатам исследования выявлена зависимость метрик от количества данных, что говорит о том, что оценку кластеризации без полного набора данных может быть не эффективной, т.е. для ограниченной выборки будет одни параметры, для полной другие.

Для эффективной работ с большим числом данных рекомендуется использовать библиотеку `FAISS` для поиска рядом находящихся векторов из-за быстроты работы на больших данных.

По итогам поиска оптимальных параметров была выявлена модель с метрикой `L1` и нормализации `MinMaxSacaler` числовых параметры. Из входных параметров были исключены параметры `6`, `33`, `59`.

Модель использовала `FAISS.IndexFlat`, так как поддерживает метрику `L1`.

Выявленная модель на проверочных данных имеет метрику `accuracy@5 = 0.7699677480553975`

Дальнейшие шаги по улучшению:
- исследовать других метрик расстояний;
- исследование влияния очищенных от выбросов данных;
- оптимизация работы модели `FAISS.IndexFlat` (возможно подключения алгоритма KMeans, плюс исследовать метрики качества кластеризации);
- исследование других алгоритмов поиска.